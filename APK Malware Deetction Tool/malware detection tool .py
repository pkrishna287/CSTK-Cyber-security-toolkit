#!/usr/bin/env python
# coding: utf-8

# In[1]:


import numpy as np
import pandas as pd
import os
for dirname, _, filenames in os.walk('/kaggle/input'):
    for filename in filenames:
        print(os.path.join(dirname, filename))


# In[6]:


df = pd.read_csv('E:\drebin-215-dataset-5560malware-9476-benign.csv')


# In[8]:


data = pd.read_csv("E:\drebin-215-dataset-5560malware-9476-benign.csv")

data['class'].replace('B', 2)
data['class'].replace('A', 1)

num_cols = data._get_numeric_data().columns
cata_columns = list(set(data.columns)- set(num_cols))
data = pd.get_dummies(data, columns=['TelephonyManager.getSimCountryIso'], drop_first = False)


X = data
y = data.pop('class')

from sklearn.model_selection import train_test_split
train_X, val_X, train_y, val_y = train_test_split (X, y, test_size= .3)

data.head()


# In[9]:


from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score

forest_model = RandomForestClassifier()
history = forest_model.fit(train_X, train_y)

pred_y = forest_model.predict(val_X)
print (accuracy_score(pred_y, val_y))


# In[10]:


import os

# Get the current working directory
current_directory = os.getcwd()

# Specify the model file name
model_filename = "random_forest_model.pkl"

# Create the full path to the model file
model_path = os.path.join(current_directory, model_filename)

# Print the model path
print("Model path:", model_path)

